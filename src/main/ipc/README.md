# 🔄 IPC 通信模块

## 📘 概述

IPC 通信模块负责处理 Electron 应用中渲染进程和主进程之间的通信，提供了一系列处理器函数来响应渲染进程的请求并返回处理结果。该模块是连接用户界面和底层功能的桥梁，确保数据和命令能够安全、高效地在不同进程间传递。

## 🏗️ 目录结构

```
/ipc/
├── handlers.ts          # 通用 IPC 处理器
├── database.handlers.ts # 数据库相关 IPC 处理器
└── llm.handlers.ts      # LLM 服务相关 IPC 处理器
```

## 🚀 核心功能

- 📨 注册和管理 IPC 通信通道
- 🔄 处理来自渲染进程的请求
- 📤 向渲染进程发送事件和数据
- 🛡️ 实现 IPC 通信的安全控制
- 🧠 处理 LLM 相关的特定请求
- 💾 处理数据库操作请求

## 🔍 主要处理器

### 通用处理器 (handlers.ts)
- 配置读写操作
- 窗口控制功能
- 系统功能调用
- 文件系统操作

### 数据库处理器 (database.handlers.ts)
- 数据查询请求处理
- 数据写入和更新
- 数据库迁移与维护

### LLM 处理器 (llm.handlers.ts)
- LLM 提供商配置管理
- API 密钥管理
- 模型参数设置
- 请求代理设置
- 聊天会话管理

## 💡 通信流程

1. 渲染进程通过预加载脚本暴露的 API 发起请求
2. 请求通过 Electron IPC 机制传递到主进程
3. 主进程中注册的相应处理器接收并处理请求
4. 处理器调用相关服务完成实际操作
5. 结果通过 Promise 返回给渲染进程
6. 渲染进程更新 UI 或执行后续操作

## 🔄 通道命名规范

IPC 通道遵循以下命名规范:
- `服务名:操作名` - 例如 `config:get`, `llm:sendMessage`
- 查询操作使用 `get` 前缀
- 更新操作使用 `update` 前缀
- 创建操作使用 `create` 前缀
- 删除操作使用 `delete` 前缀

## 🛡️ 安全考量

- 所有 IPC 处理器都应进行参数验证
- 敏感操作应当实施权限检查
- 错误应被捕获并以结构化方式返回
- 避免在 IPC 通道中传输大量数据
- 敏感数据（如 API 密钥）应妥善处理

## 🔌 依赖关系

- 依赖主进程中的各种服务实现具体功能
- 与预加载脚本协同工作，提供 API 给渲染进程
- 符合项目的 IPC 通信架构设计规范 