# RelaScope Insight - 需求设计文档 (V2 - 独立客户端版)

## 1. 系统概述与目标 🎯

RelaScope Insight 旨在成为一个强大的**独立桌面应用程序**，帮助用户建立和管理个人信息库，并通过集成的 LLM (大型语言模型) 能力进行深度分析，以获取对个体行为模式、沟通方式和潜在需求的洞察。所有数据将**存储在用户本地计算机**，确保隐私和数据主权。

**核心目标:**

*   **结构化信息管理:** 提供高效的方式来记录、组织和检索个人相关信息。
*   **智能化分析:** 利用 LLM 对收集到的信息进行多维度分析，揭示深层特征。
*   **用户数据本地化:** 所有用户数据和配置信息均安全存储于本地。
*   **易用性:** 提供简洁直观的用户界面，参考 **Cherry Studio** 的设计风格，降低使用门槛。

开发版本
React 18 、node.js 18.17.1

依赖库说明：
dependencies（生产依赖）

库名	版本	说明
electron	28.2.7	桌面端运行时，集成 Chromium 和 Node.js
react	18.2.0	构建用户界面的核心库
react-dom	18.2.0	用于在 DOM 中渲染 React 组件
@fluentui/react	8.121.0	微软推出的企业级 React UI 组件库
sqlite3	5.1.7	Node.js 原生 SQLite 驱动，适合持久化存储本地数据
axios	1.6.7	基于 Promise 的 HTTP 网络请求库
marked	11.2.0	Markdown 解析器，支持将文本渲染为 HTML
dompurify	3.0.8	DOM 清理工具，防止 XSS 攻击

devDependencies（开发依赖）

库名	版本	说明
@babel/core	7.24.0	Babel 核心模块，用于编译 ES6+
@babel/preset-env	7.23.9	Babel 预设，支持最新 JS 特性
@babel/preset-react	7.23.3	Babel 预设，支持 JSX
babel-loader	9.1.3	Babel 与 Webpack 的连接桥梁
css-loader	6.10.0	支持在 JS 中加载 CSS
style-loader	3.3.4	将 CSS 注入到 DOM 中
webpack	5.91.0	模块打包工具
webpack-cli	5.1.4	Webpack 命令行工具

## 2. 功能需求 🛠️

### 2.1 个人信息库管理 👤

*   **创建与维护:**
    *   支持建立多个独立的个人信息库。
    *   每个库包含基础信息字段：姓名 (必填)、代称、出生日期、性别、联系方式 (类型可选)、籍贯、常住地区、职业、健康状况、补充资料等。
    *   提供新建、编辑、删除个人信息库的功能。
    *   支持多选批量删除，删除操作需有二次确认弹窗。
*   **数据导出:** 提供将指定个人信息库导出为 Markdown (.md) 格式文件的功能，方便备份和迁移。

### 2.2 信息录入 ✍️

*   **语录记录:**
    *   允许持续追加目标人物的语录，自动记录添加日期。
    *   支持编辑和删除单条语录。
*   **个人经历:**
    *   允许持续追加目标人物的相关经历，自动记录添加日期。
    *   支持编辑和删除单条经历记录。

### 2.3 LLM 分析能力 🧠

*   **LLM 服务配置:**
    *   参考 **Cherry Studio** 的配置界面风格。
    *   允许用户填入所选 LLM 服务的 API 密钥。支持配置多个密钥，用逗号 `,` 分隔，按顺序尝试使用。
    *   密钥输入框提供明文/密文切换显示（小眼睛图标）。
    *   提供链接跳转至常见 LLM 平台的 API 密钥申请页面。
    *   提供 "检查连接" 按钮：点击后允许用户选择目标模型进行测试，验证 API 密钥和网络连通性。
    *   支持选择不同的 LLM 类型 (如 OpenAI GPT 系列, Anthropic Claude 系列等)。选择后自动填充默认 API 地址和推荐模型。
    *   **模型管理:** 提供界面管理用户自定义的模型列表。可新增、删除模型配置。模型字段包括：模型 ID (创建后不可修改)、模型名称。提供复制模型 ID 的便捷按钮。
*   **分析触发与执行:**
    *   **手动分析:**
        *   在选定某个个人信息库后，用户可以选择分析类型并发起分析。
        *   可选分析类型包括：六边形人性模型分析、如何打交道、如何销售给他、他可能的需求、心理状况分析、用户自定义 Prompt 类型。
        *   点击分析后，系统整合该个体的基础信息、语录、经历数据，根据所选分析类型生成相应的 Prompt，发送给配置好的 LLM 服务。
    *   **手动模式 (高级):** 提供一个选项，在发送给 LLM 前，将生成的 Prompt 显示给用户。用户可以复制此 Prompt，自行在其他 LLM 客户端或网页进行提问，然后将获取的结果手动录入到 RelaScope Insight 中，作为一次分析记录保存。
    *   **自动分析 (可选):** 考虑提供触发器选项，例如当某个体的信息（语录/经历）更新达到一定数量或频率时，自动触发重新分析 (此功能优先级可后调)。
*   **分析结果处理:**
    *   LLM 返回的分析结果将被保存，并添加到对应个人信息库的 "历史分析记录" 中。
    *   如果执行了 "六边形人性模型分析"，分析结果将用于更新该个体的六边形模型可视化展示及相关总结文字。
*   **成本与用量提示:** (建议功能)
    *   提供 API 调用次数统计或 Token 用量估算功能。
    *   考虑允许用户设置预算提醒阈值。

### 2.4 分析结果展示与可视化 ✨

*   **个人信息库主页:**
    *   选中某个信息库后，默认展示其基础信息 (摘要形式，可展开查看全部)。
    *   下方展示 "六边形人性模型" 可视化图表。
        *   包含六个维度：安全感、成就感、自由感、归属感、新奇感、掌控感。
        *   每个维度有低、中、高三个层级或更细分的评估 (基于分析结果)。
        *   未分析过则显示初始状态。
    *   模型图表下方展示：
        *   上一次 "六边形人性模型" 分析的文字总结。
        *   对应主要偏向的人性模型介绍 (内容过长时缩略显示，提供展开查看)。
        *   从未分析过则显示 "待分析"。
        *   提供按钮，点击可弹窗查看六种人性偏向模型的详细介绍 (参考附录)。
*   **历史分析数据:**
    *   在个人信息库主页下方，以卡片列表形式展示该个体所有的历史分析记录。
    *   每张卡片显示分析类型、分析时间、分析结果摘要。
    *   卡片可点击展开查看完整的分析结果。
    *   记录按分析日期降序排列 (最新的在最上方)。

### 2.5 本地存储方案 💾

*   **存储内容:**
    *   所有个人信息库数据 (基础信息、语录、经历)。
    *   所有分析历史记录。
    *   用户配置信息 (LLM API 密钥 - 需加密存储, 模型配置等)。
    *   应用程序设置。
*   **存储技术:**
    *   **采用混合方案:**
        *   **核心数据 (个人信息库、语录、经历、分析历史):** 使用 **SQLite** 数据库存储。这有利于结构化数据管理、高效查询和保证数据完整性。
        *   **配置数据 (LLM API 密钥、模型列表、应用设置):** 使用 **JSON 文件**存储 (存储在应用特定的用户数据目录中)。这便于配置的读写和管理。
    *   需要考虑数据结构的扩展性 (SQLite 的 Schema Migration) 和版本兼容性。
    *   API 密钥等敏感信息无论存储在何处，都**必须进行加密存储**。

### 2.6 用户界面 (UI) 与用户体验 (UX) 🎨

*   **技术选型:** 使用 **Electron** 框架开发跨平台桌面应用。
*   **设计风格:**
    *   整体风格参考 **Cherry Studio**，追求简洁、现代、直观。
    *   注重信息层级清晰，操作流程顺畅。
    *   合理使用图标、色彩和布局，提升视觉效果和易用性。
*   **交互细节:**
    *   重要的操作 (如删除) 需要二次确认。
    *   提供清晰的状态反馈 (如加载中、分析中、保存成功等)。
    *   长内容区域 (如补充资料、经历详情、分析结果) 应支持滚动和方便的查看。

## 3. 非功能性需求 ⚙️

*   **性能:** 应用启动速度快，界面响应流畅，大量数据时列表加载不卡顿。LLM 分析过程应有清晰的进度提示，且不阻塞 UI 主线程。
*   **安全性:** API 密钥等敏感信息必须本地加密存储。防止未经授权的访问。
*   **可靠性:** 数据存储稳定可靠，不易丢失。提供数据备份或导出功能。
*   **可维护性:** 代码结构清晰，模块化设计，易于后续迭代和维护。
*   **跨平台:** 基于 Electron，理论上应支持 Windows, macOS, Linux。需进行主要平台的测试。

## 4. 技术选型 (总结) 💻

*   **前端框架:** Electron
*   **UI 库:** (待定，可选 React + Fluent UI, Vue + Element Plus, Svelte 等)
*   **本地存储:** SQLite / JSON 文件
*   **加密库:** Node.js 内建 crypto 模块或第三方库

## 5. 附录：六边形人性偏向模型参考资料 📚

*(此处保留原始文档中的 "六边形人性偏向模型" 和 "评估标准体系" 的详细内容，作为产品内嵌的参考信息和 LLM 分析的理论基础)*

---
*(以下为原始文档内容，保持不变)*

# 六边形人性偏向模型

---
### 1. 安全感驱动（Security）
- **核心追求**：确定性、稳定、保障
- **喜欢**：熟悉环境、低风险、长期承诺
- **讨厌**：不确定、变化、冒险
- **卖东西**：强调安全、可靠、不会出问题
- **打交道**：用耐心、给承诺、减少变化
- **弱点**：
    - 害怕变化，容易错过机会
    - 过度焦虑，行动迟缓
    - 依赖性强，抗压能力弱
---

### 2. 成就感驱动（Achievement）
- **核心追求**：成功、地位、影响力
- **喜欢**：挑战、竞争、结果导向
- **讨厌**：平庸、无成就感、被忽视
- **卖东西**：突出可以带来成就、荣誉、领先别人
- **打交道**：给予认可、展示潜力和机会
- **弱点**：
    - 容易焦虑、压力大
    - 过度功利，忽视关系
    - 成败绑定自我价值，抗挫力弱
---

### 3. 自由感驱动（Freedom）
- **核心追求**：自主、掌控自己的人生
- **喜欢**：自由选择、灵活弹性、少规则
- **讨厌**：受限、强制、被管束
- **卖东西**：强调灵活性、个性化、控制权在他
- **打交道**：少设规则，多给选项，尊重自主
- **弱点**：
    - 抵触规范，执行力低
    - 冲动决策，后悔率高
    - 难以持续投入，容易放弃
---

### 4. 归属感驱动（Belonging）
- **核心追求**：关系、认同、团体归属
- **喜欢**：被接纳、一起行动、共同体验
- **讨厌**：孤立、排斥、冷漠
- **卖东西**：强调"大家都在用"、"更好的圈子"
- **打交道**：多用共情，建立情感连接
- **弱点**：
    - 过于迎合他人，失去自我
    - 容易被群体操纵
    - 害怕冲突，沟通回避
---

### 5. 新奇感驱动（Novelty）
- **核心追求**：探索、体验、新鲜感
- **喜欢**：变化、新奇、有趣的事物
- **讨厌**：单调、重复、无趣
- **卖东西**：突出创新、有趣、与众不同
- **打交道**：激发好奇心，给予刺激
- **弱点**：
    - 浅尝辄止，缺乏深度
    - 追求短期快感，难以坚持
    - 容易厌倦，换目标频繁
---

### 6. 掌控感驱动（Control）
- **核心追求**：掌控、主导、影响局势
- **喜欢**：决策权、支配权、主导行动
- **讨厌**：被支配、失控、受限制
- **卖东西**：让对方感觉是自己做主、有决策权
- **打交道**：提供信息让他掌控，尊重决策权
- **弱点**：
    - 控制欲过强，关系紧张
    - 固执己见，缺乏弹性
    - 难以协作，信任他人困难
---

# 人性六边形偏向评估标准体系
## 核心理念

- **模糊推断**：从已有线索推测倾向，而不是硬性判定。
- **偏好强度分级**：每个维度用"可能弱/中等/强"标注，不强求精准分数。
- **批评性校正**：强调持续验证，一次评估后可以随着新数据动态修正。
- **来源权重**：不同来源（语录、经历、个人信息）赋予不同推测权重。

---

## 评估步骤示例

### 1. 来源归类

对手头资料，按下列来源分类：

|来源类别|定义|特点|评估时权重建议|
|---|---|---|---|
|个人信息|性别、年龄、职业、成长环境等|宏观背景，倾向慢性影响|低-中|
|语录部分|直接表达的观点、态度、情绪|明显倾向、易受情境影响|高|
|个人经历|经历过的重大事件及反应|行为层面反映真实动机|高|

**➡️ 原则：优先相信【语录+经历】线索，信息缺失时用【个人信息】合理推断补充。**

---

### 2. 关键词与行为线索提取

#### 提取时关注：

- 出现频率（说的多/做的多的倾向往往更真实）
- 情绪强度（讲到某事是否情绪激动、强调）
- 逆反行为（特别反感什么，也说明什么偏向）

---

### 3. 六边形六维推断标准

|驱动|关键词/行为线索|低倾向表现|高倾向表现|
|---|---|---|---|
|安全感|稳定、安全、保障、保险、确定|无所谓变化、频繁跳槽|喜欢固定、抗拒冒险、强调后路|
|成就感|成功、领先、获奖、影响力、目标|对输赢无所谓、容易满足|热衷比较、争取名次、设高目标|
|自由感|自主、自由、讨厌规则、个性化|喜欢标准流程、服从组织|强烈反感被约束、强调自己决定|
|归属感|团队、关系、朋友、圈子、认同|独来独往、不在意归属|强烈想融入群体、害怕孤立|
|新奇感|新鲜、有趣、探索、体验|喜欢稳定、排斥变化|热衷尝新、旅行、变化频繁|
|掌控感|掌控、主导、决策、控制、主见|随波逐流、容易妥协|喜欢做决定、讨厌被指挥|

---

### 4. 初步打标

根据提取到的关键词、行为：

- 每个维度标注：
    - 低倾向（-1）
    - 中性（0）
    - 高倾向（+1）

如果信息充足，可以细分：

- -2（极低）
- -1（偏低）
- 0（中性）
- +1（偏高）
- +2（极高）

---

### 5. 交叉验证（批评标准）

- 语录 vs 经历：是否一致？
- 经历 vs 个人信息：是否合理？
- 多条线索是否支持同一推断？
    - **一致多次出现**：推断为稳定倾向
    - **矛盾/单次出现**：打上"待验证"标记，降低权重

---

## 举个例子

你拿到以下信息：

- 个人信息：27岁，男，自由职业者
- 语录：
    - "我讨厌被人安排，每一步我都想自己决定。"
    - "稳定太无聊了，不如来点刺激的。"
- 经历：
    - 3年换了5份工作，频繁创业尝试
    - 旅游打卡50+城市

**评估结果推测：**

|驱动|初步倾向|理由|
|---|---|---|
|安全感|低|讨厌稳定，经常跳动|
|成就感|中|创业动作多，但没明确提到功名驱动|
|自由感|高|明确表达自己掌控强烈|
|归属感|低|资料中未强调社交或群体感|
|新奇感|高|频繁旅游、喜欢刺激|
|掌控感|高|自己决定，不被安排|

—

> **小结**：这类人卖东西要突出**自由 + 新鲜感 + 他自己做决策**，而**安全感、归属感**就不用太强调。
> 打交道时给他充分的空间和自主选项，否则容易引发反感。 